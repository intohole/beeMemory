# 数据库表结构与后端路由优化计划

## 一、数据库表结构分析

经过对数据库模型的审视，目前的表结构设计清晰，职责明确，没有明显的重复功能：

1. **MemoryPriority**：定义不同内容类型的优先级
2. **UserMemory**：存储用户记忆内容
3. **AppConfig**：应用级别的配置管理
4. **ChatHistory**：存储聊天历史记录

从整体架构角度看，表结构设计合理，各表职责明确，没有重复功能。

## 二、后端路由测试与修复计划

### 1. 核心路由测试

* **POST /api/memory/submit**：提交聊天历史，生成记忆

* **POST /api/memory/query**：根据查询内容获取相似记忆

* **GET /api/memory/list**：获取用户在特定应用下的所有记忆列表

* **DELETE /api/memory/{memory\_id}**：删除指定记忆

### 2. 配置路由测试

* **GET /api/memory/app/config**：获取应用配置

* **PUT /api/memory/app/config**：更新应用配置

* **GET /api/memory/user/app/config**：获取用户应用配置

* **PUT /api/memory/user/app/config**：更新用户应用配置

### 3. 优先级路由测试

* **POST /api/memory/priorities**：创建记忆优先级

* **GET /api/memory/priorities**：获取记忆优先级列表

* **GET /api/memory/priorities/{priority\_id}**：获取单个记忆优先级

* **PUT /api/memory/priorities/{priority\_id}**：更新记忆优先级

* **DELETE /api/memory/priorities/{priority\_id}**：删除记忆优先级

### 4. 手动操作路由测试

* **PUT /api/memory/archive**：归档记忆

* **PUT /api/memory/unarchive**：取消归档记忆

* **PUT /api/memory/priority**：更新记忆优先级

* **PUT /api/memory/tags**：更新记忆标签

* **GET /api/memory/score/{memory\_id}**：获取记忆评分

## 三、前端重构计划

### 1. 核心功能保留

* **对话列表**：保留现有对话记录的展示和管理

* **记忆列表**：保留记忆的展示、搜索和管理功能

* **APP配置**：保留应用和用户级别的配置管理

### 2. 重构重点

* 优化前端代码结构，提高可维护性

* 确保前端与后端路由的正确对接

* 优化用户体验，确保核心功能易于使用

## 四、实施步骤

1. **环境准备**：确保开发环境正常运行
2. **路由测试**：逐个测试所有后端路由，记录问题
3. **问题修复**：修复测试中发现的路由问题
4. **前端评估**：评估当前前端代码，确定重构方案
5. **前端重构**：按照重构方案进行前端代码优化
6. **功能验证**：验证所有核心功能是否正常工作
7. **性能测试**：确保系统性能符合要求

## 五、预期成果

1. 所有后端路由正常可用
2. 数据库表结构清晰，无重复功能
3. 前端核心功能完整保留，代码结构优化
4. 系统整体性能和可维护性提升

